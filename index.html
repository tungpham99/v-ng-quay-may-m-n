<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>V√≤ng quay may m·∫Øn T·∫øt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== RESET & BACKGROUND ===== */
body{
    margin:0;
    height:100vh;
    font-family:system-ui;
    overflow:hidden;
    color:#fff;

    background:
        url("https://uploads.onecompiler.io/44dcw5ur7/44dcw5w7r/madao.png") no-repeat top center / contain,
        radial-gradient(circle at top,#1f2933,#020617);

    display:flex;
    justify-content:center;
    align-items:flex-end;
}

/* khung d·ªçc ki·ªÉu TikTok */
.app{
    width:100%;
    max-width:420px;
    height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:flex-end;
    padding-bottom:20px;
    box-sizing:border-box;
}

/* khu v·ª±c v√≤ng quay */
.wheel-zone{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:16px;
}

/* ===== WHEEL (RESPONSIVE) ===== */
.wheel-container{
    position:relative;
    width: min(80vw, 420px);   /* üî• desktop t·ª± to */
    aspect-ratio: 1 / 1;
    z-index:2;
}

canvas#wheel{
    width:100%;
    height:100%;
    display:block;
}

/* pointer */
.pointer{
    position:absolute;
    top:50%;
    right:-8px;
    transform:translateY(-50%) rotate(180deg);
    width:0;height:0;
    border-top:14px solid transparent;
    border-bottom:14px solid transparent;
    border-left:26px solid #fff;
}

/* ===== BUTTON ===== */
button{
    padding:12px 36px;
    font-size:16px;
    border-radius:999px;
    border:none;
    cursor:pointer;
    background:linear-gradient(135deg,#f59e0b,#ef4444);
    color:#fff;
    font-weight:700;
}
button:active{ transform:scale(.95); }

/* ===== EFFECT CANVAS ===== */
canvas#fx{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:1;
}

/* ===== POPUP ===== */
.popup{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.55);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:9;
    visibility:hidden;
}
.popup.show{ visibility:visible; }
.popup-box{
    background:#020617;
    padding:28px 32px;
    border-radius:16px;
    text-align:center;
    box-shadow:0 20px 60px rgba(0,0,0,.6);
}
</style>
</head>

<body>

<canvas id="fx"></canvas>

<div class="app">
    <div class="wheel-zone">
        <div class="wheel-container">
            <canvas id="wheel"></canvas>
            <div class="pointer"></div>
        </div>
        <button onclick="spin()">üßß QUAY üßß</button>
    </div>
</div>

<div class="popup" id="popup">
    <div class="popup-box">
        <h2 id="result"></h2>
        <button onclick="closePopup()">ƒê√≥ng</button>
    </div>
</div>

<script>
/* ===== AUDIO ===== */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();

/* ===== WHEEL SETUP (DYNAMIC SIZE) ===== */
const wheel=document.getElementById("wheel");
const ctx=wheel.getContext("2d");
const dpr=devicePixelRatio||1;

function resizeWheel(){
    const container=document.querySelector(".wheel-container");
    const size=container.clientWidth;

    wheel.width=size*dpr;
    wheel.height=size*dpr;
    ctx.setTransform(dpr,0,0,dpr,0,0);

    drawWheel();
}
window.addEventListener("resize",resizeWheel);

/* ===== DATA ===== */
const items=[
 {text:"10K",color:"#F59E0B",weight:40},
 {text:"20K",color:"#EF4444",weight:45},
 {text:"50K",color:"#EC4899",weight:10},
 {text:"100K",color:"#22C55E",weight:2},
 {text:"200K",color:"#06B6D4",weight:2},
 {text:"500K",color:"#8B5CF6",weight:1}
];

let angle=0;
let spinning=false;

/* ===== DRAW ===== */
function drawWheel(){
    const size=wheel.width/dpr;
    const center=size/2;
    const radius=center;
    const slice=2*Math.PI/items.length;

    ctx.clearRect(0,0,size,size);

    ctx.beginPath();
    ctx.arc(center,center,radius,0,Math.PI*2);
    ctx.fillStyle="#facc15";
    ctx.fill();

    items.forEach((it,i)=>{
        const a=angle+i*slice;
        ctx.beginPath();
        ctx.moveTo(center,center);
        ctx.arc(center,center,radius-18,a,a+slice);
        ctx.fillStyle=it.color;
        ctx.fill();

        ctx.save();
        ctx.translate(center,center);
        ctx.rotate(a+slice/2);
        ctx.fillStyle="#fff";
        ctx.font="bold 18px system-ui";
        ctx.textAlign="right";
        ctx.textBaseline="middle";
        ctx.fillText(it.text,radius-40,0);
        ctx.restore();
    });
}

/* ===== LOGIC ===== */
function pickIndex(){
    let total=items.reduce((s,i)=>s+i.weight,0);
    let r=Math.random()*total;
    for(let i=0;i<items.length;i++){
        r-=items[i].weight;
        if(r<=0) return i;
    }
    return 0;
}

function spin(){
    if(spinning) return;
    spinning=true;

    const idx=pickIndex();
    const slice=2*Math.PI/items.length;
    const start=angle;
    const end=6*Math.PI*2-(slice*idx+slice/2);
    let t0=null;

    function anim(t){
        if(!t0) t0=t;
        const p=Math.min((t-t0)/6000,1);
        angle=start+(end-start)*(1-Math.pow(1-p,3));
        drawWheel();
        if(p<1) requestAnimationFrame(anim);
        else{
            spinning=false;
            document.getElementById("result").innerText=
              "üéâ B·∫°n ƒë∆∞·ª£c l√¨ x√¨: "+items[idx].text;
            document.getElementById("popup").classList.add("show");
        }
    }
    requestAnimationFrame(anim);
}

function closePopup(){
    document.getElementById("popup").classList.remove("show");
}

resizeWheel();
</script>

</body>
</html>
